/*! For license information please see main.0ea0ce31.chunk.js.LICENSE.txt */
(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{20:function(e,t,a){e.exports=a(35)},25:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){"use strict";a.r(t);var i=a(0),s=a.n(i),n=a(8),o=a.n(n),r=(a(25),a(1)),h=a(4),c=a(5),d=a(3),u=a(7),l=a(6),m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CLEAR_HELP":var a=e.showHelp;return"help2"==e.currentHelp&&(a=!1),Object(r.a)(Object(r.a)({},e),{},{currentHelp:"",showHelp:a});case"USE_IMAGE":var i=e.addImagesSrc.concat();i[t.index]=t.src;var s=e.imagesTransform.concat();return Object(r.a)(Object(r.a)({},e),{},{addImagesSrc:i,imagesTransform:s,imageChanged:!0,currentHelp:"help2"});case"ROTATE_IMAGE":var n=e.imagesTransform.concat();return n[t.index].r=t.rotation,Object(r.a)(Object(r.a)({},e),{},{imagesTransform:n});case"SCALE_IMAGE":var o=e.imagesTransform.concat();return o[t.index].s=t.scale,Object(r.a)(Object(r.a)({},e),{},{imagesTransform:o});case"CLEAR_IMAGE":var h=e.addImagesSrc.concat();return h[t.index]=null,Object(r.a)(Object(r.a)({},e),{},{addImagesSrc:h,imageChanged:!0});case"SAVE_IMAGES":return Object(r.a)(Object(r.a)({},e),{},{saveImages:!0,target:t.target});case"IMAGES_SAVED":return Object(r.a)(Object(r.a)({},e),{},{resultImagesSrc:t.images,saveImages:!1,imagesSaved:!0});case"APP_INIT":return Object(r.a)(Object(r.a)({},e),t.data);case"SET_STORE_DATA":return Object(r.a)(Object(r.a)(Object(r.a)({},e),t.data),{},{loaded:!0});case"CLEAR_ACTION":return Object(r.a)(Object(r.a)({},e),{},{action:null,imageChanged:!1,imagesSaved:!1});case"RESET_ACTION":var c=[{s:1,r:0}];return Object(r.a)(Object(r.a)({},e),{},{imagesTransform:c});case"OPACITY_ON_ACTION":return Object(r.a)(Object(r.a)({},e),{},{showOpacity:!0});case"OPACITY_OFF_ACTION":return Object(r.a)(Object(r.a)({},e),{},{showOpacity:!1});default:return e}},g=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;return a.extraAction&&(t=e(t,a.extraAction)),t=m(t,a)},p=a(19),v=a(10);function f(e,t){return new Promise((function(a,i){var s,n=new Image;n.onload=function(){return a(n)},n.onerror=i,!1===(null!==(s=e)&&!!s.match(/^\s*data:([a-z]+\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\-._~:@/?%\s]*\s*$/i))&&t&&(n.crossOrigin=t),n.src=e}))}var b=function(e){var t=!1;return{promise:new Promise((function(a,i){e.then((function(e){return t?i({isCanceled:!0}):a(e)}),(function(e){return i(t?{isCanceled:!0}:e)}))})),cancel:function(){t=!0}}},y=!("undefined"===typeof window||"undefined"===typeof navigator||!("ontouchstart"in window||navigator.msMaxTouchPoints>0)),S="undefined"!==typeof File,w={touch:{react:{down:"onTouchStart",mouseDown:"onMouseDown",drag:"onTouchMove",move:"onTouchMove",mouseMove:"onMouseMove",up:"onTouchEnd",mouseUp:"onMouseUp"},native:{down:"touchstart",mouseDown:"mousedown",drag:"touchmove",move:"touchmove",mouseMove:"mousemove",up:"touchend",mouseUp:"mouseup"}},desktop:{react:{down:"onMouseDown",drag:"onDragOver",move:"onMouseMove",up:"onMouseUp"},native:{down:"mousedown",drag:"dragStart",move:"mousemove",up:"mouseup"}}},I=y?w.touch:w.desktop,O="undefined"!==typeof window&&window.devicePixelRatio?window.devicePixelRatio:1,k={x:.5,y:.5},E=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).state={drag:!1,my:null,mx:null,image:k},i.handleImageReady=function(e){var t=i.getInitialSize(e.width,e.height);t.resource=e,t.x=.5,t.y=.5,i.setState({drag:!1,image:t},i.props.onImageReady),i.props.onLoadSuccess(t)},i.clearImage=function(){i.canvas.getContext("2d").clearRect(0,0,i.canvas.width,i.canvas.height),i.setState({image:k})},i.handleMouseDown=function(e){(e=e||window.event).preventDefault(),i.setState({drag:!0,mx:null,my:null})},i.handleMouseUp=function(){i.state.drag&&(i.setState({drag:!1}),i.props.onMouseUp())},i.getElementScale=function(e,t){var a=1;if(e.style.transform){var s=/matrix\(\s*(-*\d*\.*\d*),\s*-*\d*\.*\d*,\s*-*\d*\.*\d*,\s*(-*\d*\.*\d*),\s*-*\d*\.*\d*,\s*-*\d*\.*\d*\)/gm,n=s.exec(e.style.transform);n||(n=(s=/scale\(\s*(-*\d*\.*\d*)\)/gm).exec(e.style.transform)),a=n?Number(n[1]):1}return t*=a,e.parentElement&&(t=i.getElementScale(e.parentElement,t)),t},i.handleMouseMove=function(e){if(e=e||window.event,!1!==i.state.drag){e.preventDefault();var t=1/i.getElementScale(i.props.containerref.current,1),a=(e.targetTouches?e.targetTouches[0].pageX:e.clientX)*t,s=(e.targetTouches?e.targetTouches[0].pageY:e.clientY)*t,n={mx:a,my:s},o=i.props.rotate;if(o=(o%=360)<0?o+360:o,i.state.mx&&i.state.my){var h=i.state.mx-a,c=i.state.my-s,d=i.state.image.width*i.props.scale,u=i.state.image.height*i.props.scale,l=i.getCroppingRect(),m=l.x,g=l.y;m*=d,g*=u;var p=function(e){return e*(Math.PI/180)},v=Math.cos(p(o)),f=Math.sin(p(o)),b=g+-h*f+c*v,y={x:(m+h*v+c*f)/d+1/i.props.scale*i.getXScale()/2,y:b/u+1/i.props.scale*i.getYScale()/2};i.props.onPositionChange(y),n.image=Object(r.a)(Object(r.a)({},i.state.image),y)}i.setState(n),i.props.onMouseMove(e)}},i.setCanvas=function(e){i.canvas=e},i.canvas=null,i}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.disableHiDPIScaling&&(O=1);var e=this.canvas.getContext("2d");if(this.props.image&&this.loadImage(this.props.image),this.paint(e),document){var t=!!function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(a){e=!1}return e}()&&{passive:!1},a=I.native;document.addEventListener(a.move,this.handleMouseMove,t),document.addEventListener(a.up,this.handleMouseUp,t),y&&(document.addEventListener(a.mouseMove,this.handleMouseMove,t),document.addEventListener(a.mouseUp,this.handleMouseUp,t))}}},{key:"componentDidUpdate",value:function(e,t){this.props.image&&this.props.image!==e.image||this.props.width!==e.width||this.props.height!==e.height?this.loadImage(this.props.image):this.props.image||t.image===k||this.clearImage();var a=this.canvas.getContext("2d");a.clearRect(0,0,this.canvas.width,this.canvas.height),this.paint(a),this.paintImage(a,this.state.image,this.props.border),e.image===this.props.image&&e.width===this.props.width&&e.height===this.props.height&&e.position===this.props.position&&e.scale===this.props.scale&&e.rotate===this.props.rotate&&t.my===this.state.my&&t.mx===this.state.mx&&t.image.x===this.state.image.x&&t.image.y===this.state.image.y||this.props.onImageChange()}},{key:"componentWillUnmount",value:function(){if(document){var e=I.native;document.removeEventListener(e.move,this.handleMouseMove,!1),document.removeEventListener(e.up,this.handleMouseUp,!1),y&&(document.removeEventListener(e.mouseMove,this.handleMouseMove,!1),document.removeEventListener(e.mouseUp,this.handleMouseUp,!1))}}},{key:"isVertical",value:function(){return this.props.rotate%180!==0}},{key:"getBorders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.border;return Array.isArray(e)?e:[e,e]}},{key:"getDimensions",value:function(){var e=this.props,t=e.width,a=e.height,i=e.rotate,s=e.border,n={},o=this.getBorders(s),r=Object(v.a)(o,2),h=r[0],c=r[1],d=t,u=a;return this.isVertical()?(n.width=u,n.height=d):(n.width=d,n.height=u),n.width+=2*h,n.height+=2*c,{canvas:n,rotate:i,width:t,height:a,border:s}}},{key:"getImage",value:function(){var e=this.getCroppingRect(),t=this.state.image;e.x*=t.resource.width,e.y*=t.resource.height,e.width*=t.resource.width,e.height*=t.resource.height;var a=document.createElement("canvas");this.isVertical()?(a.width=e.height,a.height=e.width):(a.width=e.width,a.height=e.height);var i=a.getContext("2d");return i.translate(a.width/2,a.height/2),i.rotate(this.props.rotate*Math.PI/180),i.translate(-a.width/2,-a.height/2),this.isVertical()&&i.translate((a.width-a.height)/2,(a.height-a.width)/2),i.drawImage(t.resource,-e.x,-e.y),a}},{key:"getImageScaledToCanvas",value:function(){var e=this.getDimensions(),t=e.width,a=e.height,i=document.createElement("canvas");return this.isVertical()?(i.width=a,i.height=t):(i.width=t,i.height=a),this.paintImage(i.getContext("2d"),this.state.image,0,1),i}},{key:"getXScale",value:function(){var e=this.props.width/this.props.height,t=this.state.image.width/this.state.image.height;return Math.min(1,e/t)}},{key:"getYScale",value:function(){var e=this.props.height/this.props.width,t=this.state.image.height/this.state.image.width;return Math.min(1,e/t)}},{key:"getCroppingRect",value:function(){var e=this.props.position||{x:this.state.image.x,y:this.state.image.y},t=1/this.props.scale*this.getXScale(),a=1/this.props.scale*this.getYScale(),i={x:e.x-t/2,y:e.y-a/2,width:t,height:a},s=0,n=1-i.width,o=0,h=1-i.height;return(this.props.disableBoundaryChecks||t>1||a>1)&&(s=-i.width,n=1,o=-i.height,h=1),Object(r.a)(Object(r.a)({},i),{},{x:Math.max(s,Math.min(i.x,n)),y:Math.max(o,Math.min(i.y,h))})}},{key:"loadImage",value:function(e){var t;S&&e instanceof File?this.loadingImage=b((t=e,new Promise((function(e,a){var i=new FileReader;i.onload=function(t){try{var i=f(t.target.result);e(i)}catch(t){a(t)}},i.readAsDataURL(t)})))).promise.then(this.handleImageReady).catch(this.props.onLoadFailure):"string"===typeof e&&(this.loadingImage=b(f(e,this.props.crossOrigin)).promise.then(this.handleImageReady).catch(this.props.onLoadFailure))}},{key:"getInitialSize",value:function(e,t){var a,i,s=this.getDimensions();return s.height/s.width>t/e?i=e*((a=this.getDimensions().height)/t):a=t*((i=this.getDimensions().width)/e),{height:a,width:i}}},{key:"paintImage",value:function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:O;if(t.resource){var s=this.calculatePosition(t,a);e.save(),e.translate(e.canvas.width/2,e.canvas.height/2),e.rotate(this.props.rotate*Math.PI/180),e.translate(-e.canvas.width/2,-e.canvas.height/2),this.isVertical()&&e.translate((e.canvas.width-e.canvas.height)/2,(e.canvas.height-e.canvas.width)/2),e.scale(i,i),e.globalCompositeOperation="destination-over",e.drawImage(t.resource,s.x,s.y,s.width,s.height),e.restore()}}},{key:"calculatePosition",value:function(e,t){e=e||this.state.image;var a=this.getBorders(t),i=Object(v.a)(a,2),s=i[0],n=i[1],o=this.getCroppingRect(),r=e.width*this.props.scale,h=e.height*this.props.scale,c=-o.x*r,d=-o.y*h;return this.isVertical()?(c+=n,d+=s):(c+=s,d+=n),{x:c,y:d,height:h,width:r}}},{key:"paint",value:function(e){e.save(),e.scale(O,O),e.translate(0,0),e.fillStyle="rgba("+this.props.color.slice(0,4).join(",")+")";var t=this.props.borderRadius,a=this.getDimensions(),i=this.getBorders(a.border),s=Object(v.a)(i,2),n=s[0],o=s[1],r=a.canvas.height,h=a.canvas.width;t=Math.max(t,0),t=Math.min(t,h/2-n,r/2-o),e.beginPath(),function(e,t,a,i,s,n){if(0===n)e.rect(t,a,i,s);else{var o=i-n,r=s-n;e.translate(t,a),e.arc(n,n,n,Math.PI,1.5*Math.PI),e.lineTo(o,0),e.arc(o,n,n,1.5*Math.PI,2*Math.PI),e.lineTo(i,r),e.arc(o,r,n,2*Math.PI,.5*Math.PI),e.lineTo(n,s),e.arc(n,r,n,.5*Math.PI,Math.PI),e.translate(-t,-a)}}(e,n,o,h-2*n,r-2*o,t),e.rect(h,0,-h,r),e.fill("evenodd"),e.restore()}},{key:"render",value:function(){var e=this.props,t=(e.scale,e.rotate,e.image,e.border,e.borderRadius,e.width,e.height,e.position,e.color,e.style),a=(e.crossOrigin,e.onLoadFailure,e.onLoadSuccess,e.onImageReady,e.onImageChange,e.onMouseUp,e.onMouseMove,e.onPositionChange,e.disableBoundaryChecks,e.disableHiDPIScaling,Object(p.a)(e,["scale","rotate","image","border","borderRadius","width","height","position","color","style","crossOrigin","onLoadFailure","onLoadSuccess","onImageReady","onImageChange","onMouseUp","onMouseMove","onPositionChange","disableBoundaryChecks","disableHiDPIScaling"])),i=this.getDimensions(),n={width:i.canvas.width,height:i.canvas.height,cursor:this.state.drag?"grabbing":"grab",touchAction:"none"},o={width:i.canvas.width*O,height:i.canvas.height*O,style:Object(r.a)(Object(r.a)({},n),t)};return o[I.react.down]=this.handleMouseDown,y&&(o[I.react.mouseDown]=this.handleMouseDown),s.a.createElement("canvas",Object.assign({id:"edtr",ref:this.setCanvas},o,a))}}]),a}(s.a.Component);E.defaultProps={scale:1,rotate:0,border:25,borderRadius:0,width:200,height:200,color:[0,0,0,.5],onLoadFailure:function(){},onLoadSuccess:function(){},onImageReady:function(){},onImageChange:function(){},onMouseUp:function(){},onMouseMove:function(){},onPositionChange:function(){},disableBoundaryChecks:!1,disableHiDPIScaling:!1};var j,M=E,R=function(e,t){return{type:"USE_IMAGE",index:e,src:t}},C=function(e){return{type:"SAVE_IMAGES",target:e}},D=function(e){return{type:"SET_STORE_DATA",data:Object(r.a)({},e)}},_=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;Object(h.a)(this,a),(i=t.call(this,e)).state={},i.store=i.props.store,i.targetRefs=[],i.containerRefs=[];for(var n=0;n<1;n++)i.targetRefs.push(s.a.createRef()),i.containerRefs.push(s.a.createRef());return i.containerRef=s.a.createRef(),i.state={},i.loadButton_clickHandler=i.loadButton_clickHandler.bind(Object(d.a)(i)),i}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.store.subscribe((function(){e.onStoreChange()})),this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe(),this.mounted=!1}},{key:"componentDidUpdate",value:function(e,t,a){}},{key:"onStoreChange",value:function(){if(this.mounted){var e=this.store.getState();if(this.setState(e),e.saveImages){for(var t=[],a=0;a<this.targetRefs.length;a++){var i=this.targetRefs[a];i.current?t.push(i.current.getImageScaledToCanvas().toDataURL(this.state.mimeType)):t.push(null)}this.store.dispatch(function(e){return{type:"IMAGES_SAVED",images:e}}(t))}}}},{key:"loadButton_clickHandler",value:function(e){var t=this,a=Number(e.target.id.substr(3)),i=e.target.files[0];if(i){var s=new FileReader;s.onload=(this.store,function(e){t.store.dispatch(R(a,e.target.result))}),s.readAsDataURL(i)}}},{key:"render",value:function(){var e=[];if(e.push(this.props.children),this.state.addImagesSrc)for(var t=0;t<this.state.addImagesSrc.length;t++){var a=this.state.addImagesSrc[t],i=this.state.addImagesTransform[t],n=this.state.imagesTransform[t];a&&""!==a&&i&&n?e.push(s.a.createElement("div",{key:"cnt"+t,id:"cnt"+t,className:"editorImageContainer",ref:this.containerRefs[t],style:{transform:"matrix(".concat(i,")"),width:this.state.addImagesRealSize.width,height:this.state.addImagesRealSize.height,pointerEvents:this.state.editable&&this.state.publishable?"all":"none"}},s.a.createElement("div",{key:"EditorCircleMask",className:"editorCircleMask",style:this.state.maskMargins},s.a.createElement(M,{ref:this.targetRefs[t],image:a,containerref:this.containerRefs[t],width:this.state.addImagesRealSize.width-this.state.maskMargins.left-this.state.maskMargins.right,height:this.state.addImagesRealSize.height-this.state.maskMargins.bottom-this.state.maskMargins.top,border:0,scale:n.s,rotate:n.r})))):e.push(s.a.createElement("div",{id:"lBt"+t,key:"lBt"+t,className:"loadButton",style:{transform:"matrix(".concat(i,")"),width:this.state.addImagesRealSize.width,height:this.state.addImagesRealSize.height,pointerEvents:this.state.editable?"all":"none"}},s.a.createElement("input",{id:"inp"+t,type:"file",onChange:this.loadButton_clickHandler,className:"loadInput"})))}return s.a.createElement("div",{id:"Editor",style:this.props.style,ref:this.containerRef},e)}}]),a}(i.Component),T=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;Object(h.a)(this,a),(i=t.call(this,e)).state={},i.store=i.props.store,i.containerRefs=[];for(var n=0;n<10;n++)i.containerRefs.push(s.a.createRef());return i.containerRef=s.a.createRef(),i.state={},i.scaleRange_changeHandler=i.scaleRange_changeHandler.bind(Object(d.a)(i)),i.rotateRange_changeHandler=i.rotateRange_changeHandler.bind(Object(d.a)(i)),i.clearButton_clickHandler=i.clearButton_clickHandler.bind(Object(d.a)(i)),i}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.store.subscribe((function(){e.onStoreChange()})),this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe(),this.mounted=!1}},{key:"componentDidUpdate",value:function(e,t,a){}},{key:"onStoreChange",value:function(){if(this.mounted){var e=this.store.getState();this.setState(e)}}},{key:"scaleRange_changeHandler",value:function(e){var t=Number(e.target.id.substr(3));this.store.dispatch(function(e,t){return{type:"SCALE_IMAGE",index:e,scale:t}}(t,e.target.value))}},{key:"rotateRange_changeHandler",value:function(e){var t=Number(e.target.id.substr(3));this.store.dispatch(function(e,t){return{type:"ROTATE_IMAGE",index:e,rotation:t}}(t,e.target.value))}},{key:"clearButton_clickHandler",value:function(e){var t=Number(e.target.id.substr(3));this.store.dispatch(function(e){return{type:"CLEAR_IMAGE",index:e}}(t,e.target.value))}},{key:"render",value:function(){var e=[];if(e.push(this.props.children),this.state.addImagesSrc)for(var t=0;t<this.state.addImagesSrc.length;t++){var a=this.state.addImagesSrc[t],i=this.state.addImagesTransform[t],n=this.state.imagesTransform[t];a&&""!==a&&i&&n&&e.push(s.a.createElement("div",{key:"ctl"+t,id:"ctl"+t,className:"controlsContainer",ref:this.containerRefs[t],style:{transform:"matrix(".concat(i,")"),width:this.state.addImagesDefaultSize.width,height:this.state.addImagesDefaultSize.height}},s.a.createElement("input",{type:"range",id:"srn"+t,name:"srn"+t,min:this.state.minScale,max:this.state.maxScale,step:"0.01",value:n.s,className:"scaleRange",onChange:this.scaleRange_changeHandler}),s.a.createElement("input",{type:"range",id:"rrn"+t,name:"rrn"+t,min:this.state.minRotation,max:this.state.maxRotation,step:"1",value:n.r,className:"rotateRange",onChange:this.rotateRange_changeHandler})))}return s.a.createElement("div",{id:"Controls",style:this.props.style,ref:this.containerRef},e)}}]),a}(i.Component),A=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).store=i.props.store,i.ref=s.a.createRef(),i.containerRef=s.a.createRef(),i.editorRef=s.a.createRef(),i.state={editorScale:.15,editorX:0,editorY:0},i.loadButton_clickHandler=i.loadButton_clickHandler.bind(Object(d.a)(i)),i.publishSaveButton_clickHandler=i.publishSaveButton_clickHandler.bind(Object(d.a)(i)),i.themeButton_clickHandler=i.themeButton_clickHandler.bind(Object(d.a)(i)),i.resetButton_clickHandler=i.resetButton_clickHandler.bind(Object(d.a)(i)),i.mouseDownHandler=i.mouseDownHandler.bind(Object(d.a)(i)),i.mouseUpHandler=i.mouseUpHandler.bind(Object(d.a)(i)),i}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.store.subscribe((function(){e.onStoreChange()})),this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe(),this.mounted=!1}},{key:"componentDidUpdate",value:function(e,t,a){this.updateBounds(this.ref.current.clientWidth,this.ref.current.clientHeight)}},{key:"onStoreChange",value:function(){if(this.mounted){var e=this.store.getState();this.setState(Object(r.a)(Object(r.a)({},this.state),e))}}},{key:"updateBounds",value:function(e,t){if((this.lastWidth!==e||this.lastHeight!==t)&&this.state.editorBounds){this.lastWidth=e,this.lastHeight=t;var a=this.state.editorBounds,i=Math.min(e/a.width,t/a.height),s=(e-a.width*i)/2/i,n=(t-a.height*i)/2/i;this.setState(Object(r.a)(Object(r.a)({},this.state),{},{editorScale:i,editorX:s,editorY:n}))}}},{key:"publish",value:function(e){var t=this;this.store.dispatch(D({publishable:!1})),setTimeout((function(){t.store.dispatch(D({publishable:!0}))}),this.state.republishInterval),this.store.dispatch(C(e))}},{key:"loadButton_clickHandler",value:function(e){var t=this,a=Number(e.target.id.substr(3)),i=e.target.files[0];if(i){var s=new FileReader;s.onload=(this.store,function(e){t.store.dispatch(R(a,e.target.result))}),s.readAsDataURL(i)}}},{key:"publishSaveButton_clickHandler",value:function(e){this.publish("save")}},{key:"themeButton_clickHandler",value:function(e){"dark"==this.state.theme?this.store.dispatch(D({theme:"light"})):this.store.dispatch(D({theme:"dark"}))}},{key:"resetButton_clickHandler",value:function(e){this.store.dispatch({type:"RESET_ACTION"})}},{key:"mouseDownHandler",value:function(e){this.store.dispatch({type:"CLEAR_HELP"});var t=e.target?e.target.id:"";"edtr"!==t&&"rrn0"!==t&&"srn0"!==t||this.store.dispatch({type:"OPACITY_ON_ACTION"})}},{key:"mouseUpHandler",value:function(){this.state.showOpacity&&this.store.dispatch({type:"OPACITY_OFF_ACTION"})}},{key:"render",value:function(){var e=[];e.push(this.props.children);if(this.state.addImagesSrc)for(var t=0;t<this.state.addImagesSrc.length;t++)this.state.addImagesSrc[t]&&""!=this.state.addImagesSrc[t]&&0;var a=this.state.addImagesSrc?this.state.addImagesSrc[0]:null,i=this.state.addImagesTransform?this.state.addImagesTransform[0]:null,n=this.state.imagesTransform?this.state.imagesTransform[0]:null;return e.push(s.a.createElement("div",{id:"EditorContainer",key:"EditorContainer",ref:this.containerRef,style:{width:this.state.editorBounds?this.state.editorBounds.width:0,height:this.state.editorBounds?this.state.editorBounds.height:0,transform:"scale(".concat(this.state.editorScale,") translateX(").concat(this.state.editorX,"px) translateY(").concat(this.state.editorY,"px)")}},s.a.createElement("div",{id:"EditorTitle",key:"EditorTitle"},s.a.createElement("img",{src:"title.svg"})),s.a.createElement("div",{id:"EditorPanel",key:"EditorPanel"},s.a.createElement("img",{id:"BackImage",key:"BackImage",style:{width:this.state.addImagesDefaultSize?this.state.addImagesDefaultSize.width:0,height:this.state.addImagesDefaultSize?this.state.addImagesDefaultSize.height:0},src:this.state.backImageSrc?this.state.backImageSrc[this.state.theme]:""}),s.a.createElement(_,{id:"Editor",key:"Editor",scale:this.state.editorScale,store:this.props.store,ref:this.editorRef,style:{width:this.state.addImagesRealSize?this.state.addImagesRealSize.width:0,height:this.state.addImagesRealSize?this.state.addImagesRealSize.height:0,transform:"matrix(".concat(this.state.addImagesScale,", 0, 0, ").concat(this.state.addImagesScale,", ").concat(this.state.addImagesRealSize?-this.state.addImagesRealSize.width/2:0,", ").concat(this.state.addImagesRealSize?-this.state.addImagesRealSize.height/2:0,")")}}),s.a.createElement("img",{id:"MainImage",key:"MainImage",src:this.state.mainImageSrc?this.state.mainImageSrc[this.state.theme]:"",style:{opacity:this.state.editable&&this.state.showOpacity?.5:1,width:this.state.addImagesDefaultSize?this.state.addImagesDefaultSize.width:0,height:this.state.addImagesDefaultSize?this.state.addImagesDefaultSize.height:0}}),s.a.createElement(T,{id:"Controls",key:"Controls",scale:this.state.editorScale,store:this.props.store,ref:this.editorRef,style:{display:this.state.editable&&this.state.publishable?"block":"none",width:this.state.addImagesDefaultSize?this.state.addImagesDefaultSize.width:0,height:this.state.addImagesDefaultSize?this.state.addImagesDefaultSize.height:0}}),s.a.createElement("div",{id:"loadButton",key:"loadButton",className:a&&""!==a?"replace":"load",style:{pointerEvents:this.state.editable&&this.state.publishable?"all":"none"}},s.a.createElement("input",{id:"inp0",type:"file",onChange:this.loadButton_clickHandler,className:"loadInput"})),s.a.createElement("div",{id:"saveButton",key:"saveButton",className:"publishButton"+(this.state.publishable&&this.state.editable&&a&&""!==a&&i&&n?" get-active":" get-disabled"),onClick:this.publishSaveButton_clickHandler}),s.a.createElement("div",{id:"themeButton",key:"themeButton",className:"theme-"+this.state.theme,onClick:this.themeButton_clickHandler,style:{pointerEvents:this.state.editable&&this.state.publishable?"all":"none"}}),s.a.createElement("div",{id:"resetButton",key:"resetButton",onClick:this.resetButton_clickHandler,style:{pointerEvents:this.state.editable&&this.state.publishable?"all":"none",display:this.state.publishable&&this.state.editable&&a&&""!==a&&i&&n?"block":"none"}})))),s.a.createElement("div",{id:"EditorPlace",style:this.props.style,ref:this.ref,onMouseDown:this.mouseDownHandler,onMouseUp:this.mouseUpHandler},e)}}]),a}(i.Component),H=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).state={},i.store=i.props.store,i}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.store.subscribe((function(){e.onStoreChange()})),this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe(),this.mounted=!1}},{key:"componentDidUpdate",value:function(e,t,a){}},{key:"onStoreChange",value:function(){if(this.mounted){var e=this.store.getState();this.setState(e)}}},{key:"render",value:function(){var e=[];return e.push(this.props.children),e.push(s.a.createElement(A,{store:this.store,key:"EditorPlace",style:{right:this.state.sideMenu?this.state.sideMenu.width:0,top:this.state.topMenu?this.state.topMenu.height:0}})),s.a.createElement("div",{id:"Container"},e)}}]),a}(i.Component),x=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).store=i.props.store,i.state={isLoading:!1,isLoaded:!1},i.loader=null,i.result=null,i}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.store.subscribe((function(){e.onStoreChange()})),this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe(),this.mounted=!1}},{key:"componentDidUpdate",value:function(e,t){}},{key:"onStoreChange",value:function(){if(this.mounted){var e=this.store.getState();e.reloadData||e.saveStorageData&&this.saveStorageData()}}},{key:"loadStorageData",value:function(){var e=this.localStorageManager.load();this.store.dispatch(function(e){return{type:"SET_STORAGE_DATA",data:e}}(e))}},{key:"saveStorageData",value:function(){this.localStorageManager.save({}),this.store.dispatch({type:"STORAGE_DATA_SAVED",data:{saveStorageData:!1}})}},{key:"render",value:function(){return null}}]),a}(i.Component),B=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).state={},i.store=i.props.store,i.actionMap={},i.appStartDelay=500,i}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.store.subscribe((function(){e.onStoreChange()})),this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe(),this.mounted=!1}},{key:"onStoreChange",value:function(){if(this.mounted){var e=this.store.getState();e.imageChanged&&(this.props.app.props.onImage(this.props.app),this.store.dispatch({type:"CLEAR_ACTION"})),e.imagesSaved&&(this.props.app.props.onImages(this.props.app,e.resultImagesSrc,e.target),this.store.dispatch({type:"CLEAR_ACTION"})),e.dataForStorageChanged&&this.store.dispatch({type:"SAVE_STORAGE_DATA",data:{saveStorageData:!0,dataForStorageChanged:null}})}}},{key:"stopTimeout",value:function(){this.loadTimeout&&(clearTimeout(this.loadTimeout),this.loadTimeout=null)}},{key:"waitForReload",value:function(){var e=this;this.stopTimeout(),this.loadTimeout=setTimeout((function(){e.store.dispatch({type:"RELOAD_STORE_DATA",data:{dataLoaded:!1,reloadData:!0,loadDataError:!1}})}),this.store.reloadTimeout)}},{key:"render",value:function(){return null}}]),a}(i.Component),L=a(18),P=a(9),U=a(2),z=a(16),N=a.n(z),W=(a(17),j={assetsUrl:".",localStoreName:"appState_221024",isMobile:new N.a(window.navigator.userAgent).mobile(),isLocal:!/^h/.test(document.location.toString()),editorBounds:{width:0,height:0},addImagesDefaultSize:{width:500,height:500},addImagesRealSize:{width:500,height:500},addImagesScale:1,maskMargins:{left:0,right:0,bottom:0,top:0},addImagesDefaultScale:.5,mainImageSrc:"",addImagesSrc:[""],addImagesTransform:[null],resultImagesSrc:[""]},Object(U.a)(j,"mainImageSrc",{}),Object(U.a)(j,"backImageSrc",{}),Object(U.a)(j,"help1ImageSrc",""),Object(U.a)(j,"help2ImageSrc",""),Object(U.a)(j,"currentHelp","help1"),Object(U.a)(j,"showHelp",!0),Object(U.a)(j,"minScale",1),Object(U.a)(j,"maxScale",20),Object(U.a)(j,"minRotation",0),Object(U.a)(j,"maxRotation",360),Object(U.a)(j,"imagesTransform",[{s:1,r:0}]),Object(U.a)(j,"editable",!0),Object(U.a)(j,"publishable",!0),Object(U.a)(j,"republishInterval",5e3),Object(U.a)(j,"theme","dark"),Object(U.a)(j,"showOpacity",!1),j),F=(a(34),Object(P.b)(g,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),G=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).state={},i.initHandler=i.initHandler.bind(Object(d.a)(i)),i.resizeHandler=i.resizeHandler.bind(Object(d.a)(i)),i}return Object(c.a)(a,[{key:"updateLayout",value:function(){var e=document.documentElement.clientWidth||document.body.clientWidth||window.innerWidth,t=document.documentElement.clientHeight||document.body.clientHeight||window.innerHeight;this.setState(Object(r.a)(Object(r.a)({},this.state),{},{windowWidth:e,windowHeight:t}))}},{key:"initHandler",value:function(e){this.updateLayout()}},{key:"resizeHandler",value:function(e){this.updateLayout()}},{key:"setData",value:function(e){F.dispatch(D(e))}},{key:"getData",value:function(e){return F.getState()}},{key:"saveImages",value:function(){F.dispatch(C())}},{key:"componentDidUpdate",value:function(e,t,a){}},{key:"componentDidMount",value:function(){var e;F.dispatch((e=W,{type:"APP_INIT",data:Object(r.a)({},e)})),window.addEventListener("load",this.initHandler),window.addEventListener("resize",this.resizeHandler),this.props.onInit(this)}},{key:"render",value:function(){return s.a.createElement(L.a,{store:F},s.a.createElement(H,{id:"Container",windowWidth:this.state.windowWidth,windowHeight:this.state.windowHeight,store:F},s.a.createElement(x,{store:F}),s.a.createElement(B,{app:this,store:F})))}}]),a}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var V=document.getElementById("editorWidget");console.log(V.getAttribute("oninit")),o.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(G,{id:"editorApp",onInit:window[V.getAttribute("oninit")],onImage:window[V.getAttribute("onimage")],onImages:window[V.getAttribute("onimages")]})),V),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[20,1,2]]]);
//# sourceMappingURL=main.0ea0ce31.chunk.js.map